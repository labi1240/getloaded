{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/lovepreetgill/Downloads/getLoaded/components/FilterSidebar.tsx"],"sourcesContent":["import React from 'react';\nimport { RiFilter3Line, RiRestartLine } from '@remixicon/react';\n\ninterface FilterOption {\n  label: string;\n  count: number;\n}\n\ninterface FilterGroupProps {\n  title: string;\n  techLabel: string;\n  options: FilterOption[];\n  selectedValues: string[];\n  onToggle: (value: string) => void;\n}\n\nconst FilterGroup: React.FC<FilterGroupProps> = ({ title, techLabel, options, selectedValues, onToggle }) => (\n  <div className=\"mb-8\">\n    <div className=\"flex items-center justify-between mb-3\">\n      <h3 className=\"text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]\">{title}</h3>\n      <span className=\"text-[9px] font-mono text-slate-300 font-bold\">{techLabel}</span>\n    </div>\n    <div className=\"space-y-1.5\">\n      {options.map((opt) => {\n        const isActive = selectedValues.includes(opt.label);\n        return (\n          <button\n            key={opt.label}\n            onClick={() => onToggle(opt.label)}\n            className={`w-full flex items-center justify-between px-3 py-2 rounded-lg text-xs font-bold transition-all border ${isActive\n              ? 'bg-slate-900 border-slate-900 text-white shadow-lg shadow-slate-900/10'\n              : 'bg-white border-slate-200 text-slate-600 hover:border-slate-300'\n              }`}\n          >\n            <span className=\"truncate pr-2\">{opt.label}</span>\n            <span className={`font-mono text-[10px] ${isActive ? 'text-slate-400' : 'text-slate-300'}`}>\n              {opt.count}\n            </span>\n          </button>\n        );\n      })}\n    </div>\n  </div>\n);\n\ninterface FilterSidebarProps {\n  kind: 'FIREARM' | 'AMMO';\n  facets: {\n    brands: FilterOption[];\n    calibers: FilterOption[];\n    casings?: FilterOption[];\n    actions?: FilterOption[];\n  };\n  filters: any;\n  setFilters: (f: any) => void;\n}\n\nconst FilterSidebar: React.FC<FilterSidebarProps> = ({ kind, facets, filters, setFilters }) => {\n  const toggleFilter = (key: string, value: string) => {\n    const current = filters[key] || [];\n    const next = current.includes(value)\n      ? current.filter((v: string) => v !== value)\n      : [...current, value];\n    setFilters({ ...filters, [key]: next });\n  };\n\n  const clearAll = () => setFilters({});\n\n  return (\n    <aside className=\"w-full lg:w-72 shrink-0\">\n      <div className=\"bg-white rounded-2xl border border-slate-200 p-6 sticky top-8 shadow-xs\">\n        <div className=\"flex items-center justify-between mb-8 pb-4 border-b border-slate-100\">\n          <div className=\"flex items-center gap-2 text-slate-900\">\n            <RiFilter3Line className=\"size-5\" />\n            <span className=\"text-sm font-black uppercase tracking-widest\">Parameters</span>\n          </div>\n          <button\n            onClick={clearAll}\n            className=\"text-[10px] font-black text-slate-400 hover:text-red-500 flex items-center gap-1 uppercase tracking-widest transition-colors\"\n          >\n            <RiRestartLine className=\"size-3.5\" /> Reset\n          </button>\n        </div>\n\n        <FilterGroup\n          title=\"Manufacturer\"\n          techLabel=\"[OEM_SOURCE]\"\n          options={facets.brands}\n          selectedValues={filters.brands || []}\n          onToggle={(val) => toggleFilter('brands', val)}\n        />\n\n        <FilterGroup\n          title=\"Chambering\"\n          techLabel={kind === 'FIREARM' ? '[CHAMBER_SPEC]' : '[CALIBER_INDEX]'}\n          options={facets.calibers}\n          selectedValues={filters.calibers || []}\n          onToggle={(val) => toggleFilter('calibers', val)}\n        />\n\n        {kind === 'AMMO' && facets.casings && (\n          <FilterGroup\n            title=\"Material\"\n            techLabel=\"[CASING_MAT]\"\n            options={facets.casings}\n            selectedValues={filters.casings || []}\n            onToggle={(val) => toggleFilter('casings', val)}\n          />\n        )}\n\n        <div className=\"mt-10 p-4 bg-slate-50 rounded-xl border border-slate-200 border-dashed\">\n          <p className=\"text-[10px] font-bold text-slate-400 leading-relaxed uppercase tracking-widest\">\n            <span className=\"text-emerald-500 font-black mr-1\">●</span>\n            Compliance Filter: Offline\n          </p>\n        </div>\n      </div>\n    </aside>\n  );\n};\n\nexport default FilterSidebar;"],"names":[],"mappings":";;;;;AACA;;;AAeA,MAAM,cAA0C,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,OAAO,EAAE,cAAc,EAAE,QAAQ,EAAE,iBACtG,yXAAC;QAAI,WAAU;;0BACb,yXAAC;gBAAI,WAAU;;kCACb,yXAAC;wBAAG,WAAU;kCAAoE;;;;;;kCAClF,yXAAC;wBAAK,WAAU;kCAAiD;;;;;;;;;;;;0BAEnE,yXAAC;gBAAI,WAAU;0BACZ,QAAQ,GAAG,CAAC,CAAC;oBACZ,MAAM,WAAW,eAAe,QAAQ,CAAC,IAAI,KAAK;oBAClD,qBACE,yXAAC;wBAEC,SAAS,IAAM,SAAS,IAAI,KAAK;wBACjC,WAAW,CAAC,sGAAsG,EAAE,WAChH,2EACA,mEACA;;0CAEJ,yXAAC;gCAAK,WAAU;0CAAiB,IAAI,KAAK;;;;;;0CAC1C,yXAAC;gCAAK,WAAW,CAAC,sBAAsB,EAAE,WAAW,mBAAmB,kBAAkB;0CACvF,IAAI,KAAK;;;;;;;uBATP,IAAI,KAAK;;;;;gBAapB;;;;;;;;;;;;KAxBA;AAyCN,MAAM,gBAA8C,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,UAAU,EAAE;IACxF,MAAM,eAAe,CAAC,KAAa;QACjC,MAAM,UAAU,OAAO,CAAC,IAAI,IAAI,EAAE;QAClC,MAAM,OAAO,QAAQ,QAAQ,CAAC,SAC1B,QAAQ,MAAM,CAAC,CAAC,IAAc,MAAM,SACpC;eAAI;YAAS;SAAM;QACvB,WAAW;YAAE,GAAG,OAAO;YAAE,CAAC,IAAI,EAAE;QAAK;IACvC;IAEA,MAAM,WAAW,IAAM,WAAW,CAAC;IAEnC,qBACE,yXAAC;QAAM,WAAU;kBACf,cAAA,yXAAC;YAAI,WAAU;;8BACb,yXAAC;oBAAI,WAAU;;sCACb,yXAAC;4BAAI,WAAU;;8CACb,yXAAC,mRAAa;oCAAC,WAAU;;;;;;8CACzB,yXAAC;oCAAK,WAAU;8CAA+C;;;;;;;;;;;;sCAEjE,yXAAC;4BACC,SAAS;4BACT,WAAU;;8CAEV,yXAAC,mRAAa;oCAAC,WAAU;;;;;;gCAAa;;;;;;;;;;;;;8BAI1C,yXAAC;oBACC,OAAM;oBACN,WAAU;oBACV,SAAS,OAAO,MAAM;oBACtB,gBAAgB,QAAQ,MAAM,IAAI,EAAE;oBACpC,UAAU,CAAC,MAAQ,aAAa,UAAU;;;;;;8BAG5C,yXAAC;oBACC,OAAM;oBACN,WAAW,SAAS,YAAY,mBAAmB;oBACnD,SAAS,OAAO,QAAQ;oBACxB,gBAAgB,QAAQ,QAAQ,IAAI,EAAE;oBACtC,UAAU,CAAC,MAAQ,aAAa,YAAY;;;;;;gBAG7C,SAAS,UAAU,OAAO,OAAO,kBAChC,yXAAC;oBACC,OAAM;oBACN,WAAU;oBACV,SAAS,OAAO,OAAO;oBACvB,gBAAgB,QAAQ,OAAO,IAAI,EAAE;oBACrC,UAAU,CAAC,MAAQ,aAAa,WAAW;;;;;;8BAI/C,yXAAC;oBAAI,WAAU;8BACb,cAAA,yXAAC;wBAAE,WAAU;;0CACX,yXAAC;gCAAK,WAAU;0CAAmC;;;;;;4BAAQ;;;;;;;;;;;;;;;;;;;;;;;AAOvE;MA9DM;uCAgES"}},
    {"offset": {"line": 234, "column": 0}, "map": {"version":3,"sources":["file:///Users/lovepreetgill/Downloads/getLoaded/components/MarketPulse.tsx"],"sourcesContent":["import React from 'react';\nimport { RiLineChartLine, RiShieldFlashLine, RiDatabase2Line } from '@remixicon/react';\n\ninterface MarketPulseProps {\n  count: number;\n  floorPrice?: string;\n  liquidity: string;\n}\n\nconst MarketPulse: React.FC<MarketPulseProps> = ({ count, floorPrice, liquidity }) => (\n  <div className=\"bg-slate-900 text-white rounded-2xl p-6 mb-8 flex flex-col md:flex-row items-center justify-between gap-6 shadow-2xl shadow-slate-900/20 border border-slate-800\">\n    <div className=\"flex items-center gap-6\">\n      <div className=\"flex items-center gap-3\">\n        <RiDatabase2Line className=\"size-5 text-slate-500\" />\n        <div>\n          <p className=\"text-[9px] font-black text-slate-500 uppercase tracking-[0.2em]\">Total Nodes</p>\n          <p className=\"text-sm font-mono font-bold\">{count} Assets Detected</p>\n        </div>\n      </div>\n      <div className=\"h-8 w-px bg-slate-800 hidden md:block\" />\n      <div className=\"flex items-center gap-3\">\n        <RiLineChartLine className=\"size-5 text-emerald-500\" />\n        <div>\n          <p className=\"text-[9px] font-black text-slate-500 uppercase tracking-[0.2em]\">Market Floor</p>\n          <p className=\"text-sm font-mono font-bold text-emerald-400\">{floorPrice || 'N/A'}</p>\n        </div>\n      </div>\n    </div>\n    <div className=\"flex items-center gap-4 bg-slate-800/50 px-5 py-2.5 rounded-xl border border-slate-700\">\n      <RiShieldFlashLine className=\"size-4 text-brand-500\" />\n      <span className=\"text-[10px] font-black uppercase tracking-[0.2em] text-slate-400\">Inventory Liquidity:</span>\n      <span className=\"text-xs font-mono font-bold text-brand-500\">{liquidity}</span>\n    </div>\n  </div>\n);\n\nexport default MarketPulse;"],"names":[],"mappings":";;;;;AACA;;;AAQA,MAAM,cAA0C,CAAC,EAAE,KAAK,EAAE,UAAU,EAAE,SAAS,EAAE,iBAC/E,yXAAC;QAAI,WAAU;;0BACb,yXAAC;gBAAI,WAAU;;kCACb,yXAAC;wBAAI,WAAU;;0CACb,yXAAC,qRAAe;gCAAC,WAAU;;;;;;0CAC3B,yXAAC;;kDACC,yXAAC;wCAAE,WAAU;kDAAkE;;;;;;kDAC/E,yXAAC;wCAAE,WAAU;;4CAA+B;4CAAM;;;;;;;;;;;;;;;;;;;kCAGtD,yXAAC;wBAAI,WAAU;;;;;;kCACf,yXAAC;wBAAI,WAAU;;0CACb,yXAAC,qRAAe;gCAAC,WAAU;;;;;;0CAC3B,yXAAC;;kDACC,yXAAC;wCAAE,WAAU;kDAAkE;;;;;;kDAC/E,yXAAC;wCAAE,WAAU;kDAAgD,cAAc;;;;;;;;;;;;;;;;;;;;;;;;0BAIjF,yXAAC;gBAAI,WAAU;;kCACb,yXAAC,uRAAiB;wBAAC,WAAU;;;;;;kCAC7B,yXAAC;wBAAK,WAAU;kCAAmE;;;;;;kCACnF,yXAAC;wBAAK,WAAU;kCAA8C;;;;;;;;;;;;;;;;;;KAtB9D;uCA2BS"}},
    {"offset": {"line": 393, "column": 0}, "map": {"version":3,"sources":["file:///Users/lovepreetgill/Downloads/getLoaded/components/QueryBar.tsx"],"sourcesContent":["import React from 'react';\nimport { RiCloseLine, RiTerminalLine } from '@remixicon/react';\n\ninterface QueryBarProps {\n  filters: any;\n  onRemove: (key: string, value: string) => void;\n  count: number;\n}\n\nconst QueryBar: React.FC<QueryBarProps> = ({ filters, onRemove, count }) => {\n  const activeFilters = Object.entries(filters).flatMap(([key, values]: [string, any]) =>\n    values.map((val: string) => ({ key, val }))\n  );\n\n  if (activeFilters.length === 0) return null;\n\n  return (\n    <div className=\"flex flex-wrap items-center gap-3 mb-6 font-mono text-[11px] bg-slate-100 p-3 rounded-xl border border-slate-200\">\n      <RiTerminalLine className=\"size-4 text-slate-400\" />\n      <span className=\"text-slate-400 font-bold uppercase mr-2 tracking-tighter\">&gt; QUERY:</span>\n      {activeFilters.map(({ key, val }) => (\n        <span\n          key={`${key}-${val}`}\n          className=\"bg-white border border-slate-300 text-slate-700 px-2 py-1 rounded flex items-center gap-1.5 shadow-xs hover:border-slate-400 transition-all cursor-pointer group\"\n          onClick={() => onRemove(key, val)}\n        >\n          <span className=\"text-[9px] font-black text-slate-400\">{key.toUpperCase()}=</span>\n          <span className=\"font-bold\">{val.toUpperCase()}</span>\n          <RiCloseLine className=\"size-3 text-slate-300 group-hover:text-red-500\" />\n        </span>\n      ))}\n      <span className=\"ml-auto text-slate-400 italic\">[{count} result(s)]</span>\n    </div>\n  );\n};\n\nexport default QueryBar;"],"names":[],"mappings":";;;;;AACA;;;AAQA,MAAM,WAAoC,CAAC,EAAE,OAAO,EAAE,QAAQ,EAAE,KAAK,EAAE;IACrE,MAAM,gBAAgB,OAAO,OAAO,CAAC,SAAS,OAAO,CAAC,CAAC,CAAC,KAAK,OAAsB,GACjF,OAAO,GAAG,CAAC,CAAC,MAAgB,CAAC;gBAAE;gBAAK;YAAI,CAAC;IAG3C,IAAI,cAAc,MAAM,KAAK,GAAG,OAAO;IAEvC,qBACE,yXAAC;QAAI,WAAU;;0BACb,yXAAC,oRAAc;gBAAC,WAAU;;;;;;0BAC1B,yXAAC;gBAAK,WAAU;0BAA2D;;;;;;YAC1E,cAAc,GAAG,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,iBAC9B,yXAAC;oBAEC,WAAU;oBACV,SAAS,IAAM,SAAS,KAAK;;sCAE7B,yXAAC;4BAAK,WAAU;;gCAAwC,IAAI,WAAW;gCAAG;;;;;;;sCAC1E,yXAAC;4BAAK,WAAU;sCAAa,IAAI,WAAW;;;;;;sCAC5C,yXAAC,iRAAW;4BAAC,WAAU;;;;;;;mBANlB,GAAG,IAAI,CAAC,EAAE,KAAK;;;;;0BASxB,yXAAC;gBAAK,WAAU;;oBAAgC;oBAAE;oBAAM;;;;;;;;;;;;;AAG9D;KAzBM;uCA2BS"}},
    {"offset": {"line": 491, "column": 0}, "map": {"version":3,"sources":["file:///Users/lovepreetgill/Downloads/getLoaded/components/ProductCard.tsx"],"sourcesContent":["import Link from 'next/link';\nimport React, { useMemo } from 'react';\nimport { Product } from '../types';\nimport {\n  RiExternalLinkLine,\n  RiScales3Line,\n  RiShareLine,\n  RiFlagLine,\n  RiTimerLine,\n  RiFlashlightLine\n} from '@remixicon/react';\n\ninterface ProductCardProps {\n  firearm: Product;\n  isComparing?: boolean;\n  onToggleCompare?: () => void;\n}\n\nconst ProductCard: React.FC<ProductCardProps> = ({ firearm, isComparing, onToggleCompare }) => {\n\n  // Stable random time based on ID\n  const updatedTime = useMemo(() => {\n    if (!firearm?.id) return 30;\n    const hash = firearm.id.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);\n    return (hash % 86) + 5; // 5 to 90 minutes\n  }, [firearm?.id]);\n\n  const sortedOffers = useMemo(() => {\n    if (!firearm?.offers) return [];\n    return [...firearm.offers].sort((a, b) => {\n      if (a.inStock !== b.inStock) return a.inStock ? -1 : 1;\n      return a.price - b.price;\n    });\n  }, [firearm?.offers]);\n\n  const bestOffer = sortedOffers.length > 0 ? sortedOffers[0] : null;\n  const offerCount = firearm?.offers?.length || 0;\n\n  if (!firearm || !bestOffer) return null;\n\n  const basePath = firearm.kind === 'FIREARM' ? '/firearms' : '/ammo';\n  const productUrl = `${basePath}/${firearm.slug}`;\n\n  return (\n    <Link\n      href={productUrl}\n      className={`bg-white rounded-xl shadow-xs border border-slate-200 hover:shadow-md transition-all duration-200 overflow-hidden flex flex-col sm:flex-row cursor-pointer group/card relative block ${isComparing ? 'ring-2 ring-brand-500 border-brand-500' : ''}`}\n    >\n      {/* Image Section */}\n      <div className=\"relative w-full sm:w-48 h-48 sm:h-auto bg-slate-50 flex items-center justify-center p-4 border-b sm:border-b-0 sm:border-r border-slate-100 shrink-0\">\n        <img\n          src={firearm.image}\n          onError={(e) => {\n            e.currentTarget.src = '/placeholder.jpg';\n            e.currentTarget.onerror = null; // Prevent infinite loop\n          }}\n          alt={firearm.title}\n          className=\"max-w-full max-h-full object-contain mix-blend-multiply transition-transform duration-300 group-hover/card:scale-105\"\n        />\n        <button\n          onClick={(e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            onToggleCompare?.();\n          }}\n          className={`absolute top-3 left-3 p-1.5 rounded-lg transition-all shadow-xs z-10 ${isComparing\n            ? 'bg-brand-600 text-white'\n            : 'bg-white text-slate-400 hover:text-brand-600'\n            }`}\n          title=\"Add to Compare\"\n        >\n          <RiScales3Line className=\"size-4\" />\n        </button>\n      </div>\n\n      {/* Content Section */}\n      <div className=\"flex-1 p-5 flex flex-col justify-between\">\n        <div>\n          <div className=\"flex items-center flex-wrap gap-x-2 gap-y-1 mb-2\">\n            <span className=\"text-[10px] font-black uppercase tracking-widest text-slate-500\">{firearm.brand.name}</span>\n            <span className=\"text-slate-300 text-xs\">•</span>\n            <div className=\"flex items-center gap-1 text-[10px] font-bold text-yellow-600\">\n              <RiFlashlightLine className=\"size-3\" />\n              {offerCount} Offers\n            </div>\n            <span className=\"text-slate-300 text-xs\">•</span>\n            <div className=\"flex items-center gap-1 text-[10px] font-bold text-slate-400\">\n              <RiTimerLine className=\"size-3\" />\n              Updated {updatedTime}m ago\n            </div>\n          </div>\n\n          <div className=\"flex items-center justify-between gap-2 mb-1\">\n            <h3 className=\"text-lg font-bold text-slate-900 leading-tight group-hover/card:text-brand-700 transition-colors\">\n              {firearm.title}\n            </h3>\n            {bestOffer.inStock ? (\n              <span className=\"shrink-0 inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold bg-brand-100 text-brand-700 uppercase\">\n                In Stock\n              </span>\n            ) : (\n              <span className=\"shrink-0 inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold bg-slate-100 text-slate-500 uppercase\">\n                Out of Stock\n              </span>\n            )}\n          </div>\n\n          <div className=\"flex flex-wrap gap-2 text-sm text-slate-500\">\n            <span className=\"px-2 py-1 bg-slate-100 rounded text-xs font-semibold\">{firearm.caliber || '9mm'}</span>\n            <span className=\"px-2 py-1 bg-slate-100 rounded text-xs font-semibold\">{firearm.barrelLength || '4.0\"'} BBL</span>\n            <span className=\"px-2 py-1 bg-slate-100 rounded text-xs font-semibold\">{firearm.capacity || '15'} Rds</span>\n          </div>\n        </div>\n\n        <div className=\"mt-4 flex items-end justify-between border-t border-slate-100 pt-4\">\n          <div className=\"flex flex-col\">\n            <div className=\"text-xs text-slate-400 font-medium\">\n              Sold by <span className={`font-bold ${bestOffer.inStock ? 'text-slate-700' : 'text-slate-400'}`}>{bestOffer.retailer.name}</span>\n            </div>\n            <div className=\"text-[10px] text-slate-400 mt-1 uppercase tracking-tight font-bold\">\n              {bestOffer.freeShipping ? 'Free Shipping' : `+ $${bestOffer.shippingCost} Shipping`}\n            </div>\n          </div>\n\n          <div className=\"flex flex-col items-end\">\n            <div className={`text-2xl font-black tabular-nums leading-none mb-3 ${bestOffer.inStock ? 'text-slate-900' : 'text-slate-400'}`}>\n              ${bestOffer.price.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}\n            </div>\n\n            <button\n              disabled={!bestOffer.inStock}\n              onClick={(e) => {\n                e.preventDefault();\n                e.stopPropagation();\n              }}\n              className={`w-full sm:w-32 inline-flex items-center justify-center gap-2 rounded-lg px-4 py-2 text-xs font-bold transition-all ${!bestOffer.inStock\n                ? 'bg-slate-100 text-slate-400 cursor-not-allowed'\n                : 'bg-slate-900 text-white hover:bg-slate-800'\n                }`}\n            >\n              {bestOffer.inStock ? 'View Deal' : 'Sold Out'}\n              {bestOffer.inStock && <RiExternalLinkLine className=\"size-3.5\" />}\n            </button>\n\n            <div className=\"flex items-center gap-4 mt-2 px-1\">\n              <button onClick={(e) => { e.preventDefault(); e.stopPropagation(); }} className=\"flex items-center gap-1 text-[11px] font-bold text-slate-400 hover:text-slate-600 transition-colors\">\n                <RiShareLine className=\"size-3.5\" /> Share\n              </button>\n              <button onClick={(e) => { e.preventDefault(); e.stopPropagation(); }} className=\"flex items-center gap-1 text-[11px] font-bold text-slate-400 hover:text-red-500 transition-colors\">\n                <RiFlagLine className=\"size-3.5\" /> Report\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </Link>\n  );\n};\n\nexport default ProductCard;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 901, "column": 0}, "map": {"version":3,"sources":["file:///Users/lovepreetgill/Downloads/getLoaded/components/AmmoCard.tsx"],"sourcesContent":["import Link from 'next/link';\nimport React, { useMemo } from 'react';\nimport { Product } from '../types';\nimport {\n  RiExternalLinkLine,\n  RiScales3Line,\n  RiShareLine,\n  RiFlagLine,\n  RiTimerLine,\n  RiFlashlightLine\n} from '@remixicon/react';\n\ninterface AmmoCardProps {\n  product: Product;\n  isComparing?: boolean;\n  onToggleCompare?: () => void;\n}\n\nconst AmmoCard: React.FC<AmmoCardProps> = ({ product, isComparing, onToggleCompare }) => {\n\n  const updatedTime = useMemo(() => {\n    if (!product?.id) return 30;\n    const hash = product.id.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);\n    return (hash % 86) + 5; // 5 to 90 minutes\n  }, [product?.id]);\n\n  const sortedOffers = useMemo(() => {\n    if (!product?.offers) return [];\n    return [...product.offers].sort((a, b) => {\n      if (a.inStock !== b.inStock) return a.inStock ? -1 : 1;\n      if (a.cpr && b.cpr) return a.cpr - b.cpr;\n      return a.price - b.price;\n    });\n  }, [product?.offers]);\n\n  const bestOffer = sortedOffers.length > 0 ? sortedOffers[0] : null;\n\n  if (!product || !bestOffer) return null;\n  const isInStock = bestOffer.inStock;\n\n  return (\n    <Link\n      href={`/ammo/${product.slug}`}\n      className={`\n        bg-white rounded-xl shadow-xs border border-slate-200 \n        hover:shadow-md transition-all duration-200 \n        flex flex-col sm:flex-row items-stretch overflow-hidden cursor-pointer block\n        ${isInStock ? 'border-l-4 border-l-brand-500' : 'border-l-4 border-l-slate-300'}\n        ${isComparing ? 'ring-2 ring-brand-500' : ''}\n      `}\n    >\n      <div className=\"relative w-full sm:w-32 bg-slate-50 flex items-center justify-center p-3 border-b sm:border-b-0 sm:border-r border-slate-100 shrink-0\">\n        <img\n          src={product.image}\n          onError={(e) => {\n            e.currentTarget.src = '/placeholder.jpg';\n            e.currentTarget.onerror = null; // Prevent infinite loop\n          }}\n          alt={product.title}\n          className=\"w-16 h-16 sm:w-20 sm:h-20 object-contain mix-blend-multiply opacity-90 transition-opacity\"\n        />\n        <button\n          onClick={(e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            onToggleCompare?.();\n          }}\n          className={`absolute top-2 left-2 p-1 rounded-md transition-all shadow-xs z-10 ${isComparing\n            ? 'bg-brand-600 text-white'\n            : 'bg-white text-slate-400 hover:text-brand-600'\n            }`}\n          title=\"Compare\"\n        >\n          <RiScales3Line className=\"size-3.5\" />\n        </button>\n      </div>\n\n      <div className=\"flex-1 p-4 flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n        <div className=\"flex flex-col justify-center min-w-0 flex-1\">\n          <div className=\"flex items-center flex-wrap gap-x-2 gap-y-1 mb-1\">\n            <span className=\"text-[10px] font-black uppercase tracking-widest text-slate-500\">{product.brand.name}</span>\n            <span className=\"text-slate-300 text-xs\">•</span>\n            <div className=\"flex items-center gap-1 text-[10px] font-bold text-yellow-600\">\n              <RiFlashlightLine className=\"size-3\" />\n              {product.offers.length} Offers\n            </div>\n            <span className=\"text-slate-300 text-xs\">•</span>\n            <div className=\"flex items-center gap-1 text-[10px] font-bold text-slate-400\">\n              <RiTimerLine className=\"size-3\" />\n              Updated {updatedTime}m ago\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-2\">\n            <h3 className=\"text-base font-bold text-slate-900 leading-tight pr-2\">\n              {product.title}\n            </h3>\n            {!isInStock && (\n              <span className=\"shrink-0 text-[10px] font-bold text-slate-400 uppercase tracking-tight\">(Sold Out)</span>\n            )}\n          </div>\n\n          <div className=\"mt-2 flex items-center gap-3 text-xs font-medium text-slate-500\">\n            <span className=\"px-1.5 py-0.5 bg-slate-100 rounded text-slate-700\">{product.caliber}</span>\n            <span className=\"text-slate-300\">•</span>\n            <span>{product.grain}gr</span>\n            <span className=\"text-slate-300\">•</span>\n            <span>{product.casing}</span>\n          </div>\n        </div>\n\n        <div className=\"flex flex-row sm:flex-col items-center sm:items-end justify-between sm:justify-center min-w-[140px] border-t sm:border-t-0 sm:border-l border-slate-100 pt-3 sm:pt-0 sm:pl-4\">\n          <div className=\"flex flex-col items-end\">\n            <div className=\"flex items-baseline\">\n              <span className={`text-xl font-bold tracking-tight tabular-nums ${isInStock ? 'text-brand-600' : 'text-slate-400'}`}>\n                ${bestOffer.cpr?.toFixed(2)}\n              </span>\n              <span className=\"ml-1 text-[10px] font-bold uppercase text-slate-400\">/ rd</span>\n            </div>\n            <div className=\"text-[10px] font-medium text-slate-400\">\n              ${bestOffer.price.toFixed(2)} total\n            </div>\n          </div>\n\n          <div className=\"flex flex-col items-end mt-3\">\n            <button\n              disabled={!isInStock}\n              onClick={(e) => { e.preventDefault(); e.stopPropagation(); }}\n              className={`px-3 py-1.5 rounded-lg text-xs font-bold transition-all ${!isInStock\n                ? 'bg-slate-100 text-slate-400'\n                : 'bg-slate-900 text-white hover:bg-slate-800'\n                }`}\n            >\n              View Deal\n            </button>\n\n            <div className=\"flex items-center gap-3 mt-2 px-1\">\n              <button onClick={(e) => { e.preventDefault(); e.stopPropagation(); }} className=\"flex items-center gap-1 text-[10px] font-bold text-slate-400 hover:text-slate-600 transition-colors\">\n                <RiShareLine className=\"size-3\" /> Share\n              </button>\n              <button onClick={(e) => { e.preventDefault(); e.stopPropagation(); }} className=\"flex items-center gap-1 text-[10px] font-bold text-slate-400 hover:text-red-500 transition-colors\">\n                <RiFlagLine className=\"size-3.5\" /> Report\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </Link>\n  );\n};\n\nexport default AmmoCard;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1311, "column": 0}, "map": {"version":3,"sources":["file:///Users/lovepreetgill/Downloads/getLoaded/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\nimport { Pool } from 'pg'\nimport { PrismaPg } from '@prisma/adapter-pg'\n\nconst connectionString = process.env.DATABASE_URL\n\nconst pool = new Pool({ connectionString })\nconst adapter = new PrismaPg(pool)\n\nconst prismaClientSingleton = () => {\n    return new PrismaClient({ adapter })\n}\n\ndeclare global {\n    var prisma: undefined | ReturnType<typeof prismaClientSingleton>\n}\n\nconst prisma = globalThis.prisma ?? prismaClientSingleton()\n\nexport default prisma\n\nif (process.env.NODE_ENV !== 'production') globalThis.prisma = prisma\n"],"names":[],"mappings":";;;;AAIyB;AAJzB;AACA;AACA;;;;AAEA,MAAM,mBAAmB,uWAAO,CAAC,GAAG,CAAC,YAAY;AAEjD,MAAM,OAAO,IAAI,wNAAI,CAAC;IAAE;AAAiB;AACzC,MAAM,UAAU,IAAI,0QAAQ,CAAC;AAE7B,MAAM,wBAAwB;IAC1B,OAAO,IAAI,yZAAY,CAAC;QAAE;IAAQ;AACtC;AAMA,MAAM,SAAS,WAAW,MAAM,IAAI;uCAErB;AAEf,wCAA2C,WAAW,MAAM,GAAG"}},
    {"offset": {"line": 1342, "column": 0}, "map": {"version":3,"sources":["file:///Users/lovepreetgill/Downloads/getLoaded/lib/actions.ts"],"sourcesContent":["// 'use server';\n\nimport prisma from './prisma';\nimport { Product, Offer, Brand, Retailer } from '../types';\nimport { cacheLife, cacheTag } from 'next/cache';\n\n\nexport async function getRetailers(): Promise<Retailer[]> {\n    \"use cache\"\n    cacheLife(\"days\")\n    const retailers = await prisma.retailer.findMany({\n        orderBy: { name: 'asc' }\n    });\n    return retailers.map((r: any) => ({\n        id: r.id,\n        name: r.name,\n        domain: r.domain,\n        logo: r.logo || null\n    }));\n}\n\n\nexport async function getOffers(itemId: string): Promise<Offer[]> {\n    \"use cache\"\n    cacheLife(\"hours\")\n    cacheTag(`offers-${itemId}`)\n    const offers = await prisma.offer.findMany({\n        where: { itemId },\n        include: { retailer: true },\n        orderBy: { price: 'asc' }\n    });\n\n    return offers.map((offer: any) => ({\n        id: offer.id,\n        itemId: offer.itemId,\n        retailerId: offer.retailerId,\n        url: offer.url,\n        inStock: offer.inStock || false,\n        price: offer.price,\n        shippingCost: offer.shippingCost || 0,\n        total: offer.total || offer.price,\n        freeShipping: offer.freeShipping || false,\n        retailer: {\n            id: offer.retailer.id,\n            name: offer.retailer.name,\n            domain: offer.retailer.domain,\n            logo: offer.retailer.logo\n        },\n        roundCount: offer.unitsCount || undefined,\n        cpr: offer.totalUnitPrice || (offer.unitsCount && offer.unitsCount > 0 ? offer.price / offer.unitsCount : undefined)\n    }));\n}\n\n\nexport async function getProducts(kind: 'FIREARM' | 'AMMO', limit = 50, skip = 0): Promise<Product[]> {\n    \"use cache\"\n    cacheLife(\"minutes\")\n    cacheTag(`products-${kind.toLowerCase()}`)\n    const items = await prisma.catalogItem.findMany({\n        where: {\n            kind: kind,\n            // Filter out items without offers for now to show meaningful data\n            offerCount: { gt: 0 }\n        },\n        take: limit,\n        skip: skip,\n        include: {\n            Brand: true,\n            Offer: {\n                include: {\n                    retailer: true\n                }\n            },\n            FirearmSpecs: {\n                include: {\n                    FirearmChamber: {\n                        include: {\n                            Caliber: true\n                        }\n                    }\n                }\n            },\n            AmmoSpecs: {\n                include: {\n                    Caliber: true\n                }\n            }\n        },\n        orderBy: {\n            bestPrice: 'asc' // Sort by best price ascending\n        }\n    });\n\n    return items.map(mapToProduct);\n}\n\nexport async function getProduct(id: string): Promise<Product | null> {\n    \"use cache\"\n    cacheLife(\"minutes\")\n    const item = await prisma.catalogItem.findUnique({\n        where: { id },\n        include: {\n            Brand: true,\n            Offer: {\n                include: {\n                    retailer: true\n                },\n                orderBy: {\n                    price: 'asc'\n                }\n            },\n            FirearmSpecs: {\n                include: {\n                    FirearmChamber: {\n                        include: {\n                            Caliber: true\n                        }\n                    }\n                }\n            },\n            AmmoSpecs: {\n                include: {\n                    Caliber: true\n                }\n            }\n        }\n    });\n\n    if (!item) return null;\n\n    return mapToProduct(item);\n}\n\n\nexport async function getProductBySlug(slug: string): Promise<Product | null> {\n    \"use cache\"\n    cacheLife(\"max\")\n    const item = await prisma.catalogItem.findUnique({\n        where: { slug },\n        include: {\n            Brand: true,\n            // Offer removed to allow separate caching (dynamic vs static)\n            FirearmSpecs: {\n                include: {\n                    FirearmChamber: {\n                        include: {\n                            Caliber: true\n                        }\n                    }\n                }\n            },\n            AmmoSpecs: {\n                include: {\n                    Caliber: true\n                }\n            }\n        }\n    });\n\n    if (!item) return null;\n\n    return mapToProduct(item);\n}\n\n\nexport async function getProductsByIds(ids: string[]): Promise<Product[]> {\n    \"use cache\"\n    cacheLife(\"minutes\")\n    if (!ids || ids.length === 0) return [];\n\n    const items = await prisma.catalogItem.findMany({\n        where: {\n            id: { in: ids }\n        },\n        include: {\n            Brand: true,\n            Offer: {\n                include: {\n                    retailer: true\n                },\n                orderBy: {\n                    price: 'asc'\n                }\n            },\n            FirearmSpecs: {\n                include: {\n                    FirearmChamber: {\n                        include: {\n                            Caliber: true\n                        }\n                    }\n                }\n            },\n            AmmoSpecs: {\n                include: {\n                    Caliber: true\n                }\n            }\n        }\n    });\n\n    return items.map(mapToProduct);\n}\n\n\nexport async function getPairedProduct(itemId: string): Promise<Product | null> {\n    \"use cache\"\n    cacheLife(\"minutes\")\n\n    // 1. Get the item to determine its type and specs\n    const item = await prisma.catalogItem.findUnique({\n        where: { id: itemId },\n        include: {\n            FirearmSpecs: {\n                include: {\n                    FirearmChamber: {\n                        include: {\n                            Caliber: true\n                        }\n                    }\n                }\n            },\n            AmmoSpecs: {\n                include: {\n                    Caliber: true\n                }\n            }\n        }\n    });\n\n    if (!item) return null;\n\n    let caliberId: number | undefined;\n\n    // Determine caliber based on item type\n    if (item.kind === 'FIREARM' && item.FirearmSpecs && item.FirearmSpecs.FirearmChamber && item.FirearmSpecs.FirearmChamber.length > 0) {\n        caliberId = item.FirearmSpecs.FirearmChamber[0].caliberId;\n    } else if (item.kind === 'AMMO' && item.AmmoSpecs) {\n        caliberId = item.AmmoSpecs.caliberId;\n    }\n\n    if (!caliberId) return null;\n\n    // 2. Find best pairing matching this caliber\n    // If input is Firearm, look for Ammo. If input is Ammo, look for Firearm.\n    const targetKind = item.kind === 'FIREARM' ? 'AMMO' : 'FIREARM';\n\n    let pairedItem = await prisma.catalogItem.findFirst({\n        where: {\n            kind: targetKind,\n            OR: [\n                { AmmoSpecs: { caliberId: caliberId } },\n                { FirearmSpecs: { FirearmChamber: { some: { caliberId: caliberId } } } }\n            ],\n            offerCount: { gt: 0 }\n        },\n        orderBy: [\n            { bestPrice: 'asc' }, // Best value\n            { upvotes: 'desc' } // Most popular\n        ],\n        include: {\n            Brand: true,\n            Offer: {\n                include: {\n                    retailer: true\n                },\n                orderBy: {\n                    price: 'asc'\n                },\n                take: 1\n            },\n            FirearmSpecs: {\n                include: {\n                    FirearmChamber: {\n                        include: {\n                            Caliber: true\n                        }\n                    }\n                }\n            },\n            AmmoSpecs: {\n                include: {\n                    Caliber: true\n                }\n            }\n        }\n    });\n\n    // Smart Fallback: If no direct match is found, check for \"combo\" calibers\n    // e.g. Firearm is \"45 Long Colt, 410 Bore\" (ID=373) -> match Ammo \"45 Long Colt\" (ID=35)\n    if (!pairedItem && caliberId) {\n        // Fetch the caliber name of the original item\n        const caliber = await prisma.caliber.findUnique({\n            where: { id: caliberId }\n        });\n\n        if (caliber && caliber.name) {\n            // Split by comma\n            const parts: string[] = caliber.name.split(',').map((s: string) => s.trim()).filter((s: string) => s.length > 0);\n\n            if (parts.length > 1) {\n                // Find IDs for these constituent caliber names\n                // We use findMany because the names might not be unique (though ideally they are)\n                const constituentCalibers = await prisma.caliber.findMany({\n                    where: {\n                        name: { in: parts, mode: 'insensitive' }\n                    }\n                });\n\n                const constituentIds = constituentCalibers.map((c: { id: number }) => c.id);\n\n                if (constituentIds.length > 0) {\n                    pairedItem = await prisma.catalogItem.findFirst({\n                        where: {\n                            kind: targetKind,\n                            OR: [\n                                { AmmoSpecs: { caliberId: { in: constituentIds } } },\n                                { FirearmSpecs: { FirearmChamber: { some: { caliberId: { in: constituentIds } } } } }\n                            ],\n                            offerCount: { gt: 0 }\n                        },\n                        orderBy: [\n                            { bestPrice: 'asc' },\n                            { upvotes: 'desc' }\n                        ],\n                        include: {\n                            Brand: true,\n                            Offer: {\n                                include: {\n                                    retailer: true\n                                },\n                                orderBy: {\n                                    price: 'asc'\n                                },\n                                take: 1\n                            },\n                            FirearmSpecs: {\n                                include: {\n                                    FirearmChamber: {\n                                        include: {\n                                            Caliber: true\n                                        }\n                                    }\n                                }\n                            },\n                            AmmoSpecs: {\n                                include: {\n                                    Caliber: true\n                                }\n                            }\n                        }\n                    });\n                }\n            }\n        }\n    }\n\n    if (!pairedItem) return null;\n\n    return mapToProduct(pairedItem);\n}\n\n\nfunction mapToProduct(item: any): Product {\n    // Map Brand\n    const brand: Brand = {\n        id: item.Brand?.id || 0,\n        name: item.Brand?.name || 'Unknown Brand',\n        slug: item.Brand?.slug || '',\n        logo: item.Brand?.logo || null\n    };\n\n    // Map Offers\n    const offers: Offer[] = (item.Offer || []).map((offer: any) => ({\n        id: offer.id,\n        itemId: offer.itemId,\n        retailerId: offer.retailerId,\n        url: offer.url,\n        inStock: offer.inStock || false,\n        price: offer.price,\n        shippingCost: offer.shippingCost || 0,\n        total: offer.total || offer.price, // Fallback\n        freeShipping: offer.freeShipping || false,\n        retailer: {\n            id: offer.retailer.id,\n            name: offer.retailer.name,\n            domain: offer.retailer.domain,\n            logo: offer.retailer.logo\n        },\n        roundCount: offer.unitsCount || undefined,\n        cpr: offer.totalUnitPrice || (offer.unitsCount && offer.unitsCount > 0 ? offer.price / offer.unitsCount : undefined)\n    }));\n\n    // Common Product Fields\n    const product: Product = {\n        id: item.id,\n        slug: item.slug, // Map slug\n        kind: item.kind === 'FIREARM' ? 'FIREARM' : 'AMMO',\n        title: item.title,\n        image: item.image || '/placeholder.jpg',\n        brand: brand,\n        offers: offers,\n        priceHistory: [] // TODO: Implement if needed\n    };\n\n    // Specs Mapping\n    if (item.kind === 'FIREARM' && item.FirearmSpecs) {\n        const specs = item.FirearmSpecs;\n        const caliberName = specs.FirearmChamber?.[0]?.Caliber?.name; // Take first caliber\n\n        product.caliber = caliberName || 'Unknown';\n        product.capacity = specs.capacity || undefined;\n        product.barrelLength = specs.barrelLengthIn ? `${specs.barrelLengthIn}\"` : undefined;\n    } else if (item.kind === 'AMMO' && item.AmmoSpecs) {\n        const specs = item.AmmoSpecs;\n\n        product.grain = specs.grain || undefined;\n        product.casing = specs.casing || undefined;\n        product.velocity = specs.velocity || undefined;\n        product.type = specs.bulletType || undefined;\n        product.caliber = specs.Caliber?.name || undefined;\n    }\n\n    return product;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1810, "column": 0}, "map": {"version":3,"sources":["file:///Users/lovepreetgill/Downloads/getLoaded/components/CategoryPage.tsx"],"sourcesContent":["'use client';\n\nimport React, { useMemo, useState, useTransition } from 'react';\nimport Fuse from 'fuse.js';\nimport { RiSearch2Line, RiLoader4Line } from '@remixicon/react';\nimport { useGlobal } from './GlobalProvider';\nimport FilterSidebar from './FilterSidebar';\nimport MarketPulse from './MarketPulse';\nimport QueryBar from './QueryBar';\nimport { Product } from '../types';\nimport ProductCard from './ProductCard';\nimport AmmoCard from './AmmoCard';\nimport { useQueryState, parseAsString, parseAsArrayOf, parseAsStringLiteral } from 'nuqs';\nimport { getProducts } from '@/lib/actions';\n\ninterface CategoryPageProps {\n    kind: 'FIREARM' | 'AMMO';\n    initialProducts: Product[];\n}\n\nconst CategoryPage: React.FC<CategoryPageProps> = ({ kind, initialProducts }) => {\n    // 1. NUQS State for URL-driven filters\n    const [searchQuery, setSearchQuery] = useQueryState('q', parseAsString.withDefault(''));\n    const [brandsFilter, setBrandsFilter] = useQueryState('brands', parseAsArrayOf(parseAsString).withDefault([]));\n    const [calibersFilter, setCalibersFilter] = useQueryState('calibers', parseAsArrayOf(parseAsString).withDefault([]));\n    const [casingsFilter, setCasingsFilter] = useQueryState('casings', parseAsArrayOf(parseAsString).withDefault([]));\n\n    const {\n        blockedRetailers,\n        compareIds,\n        toggleCompare\n    } = useGlobal();\n\n    // 2. Load More State\n    const [products, setProducts] = useState<Product[]>(initialProducts);\n    const [offset, setOffset] = useState(initialProducts.length);\n    const [hasMore, setHasMore] = useState(true); // Assumption: if initial < 50, maybe false?\n    const [isPending, startTransition] = useTransition();\n\n    const handleLoadMore = () => {\n        startTransition(async () => {\n            const nextBatch = await getProducts(kind, 50, offset);\n            if (nextBatch.length === 0) {\n                setHasMore(false);\n            } else {\n                setProducts(prev => {\n                    const existingIds = new Set(prev.map(p => p.id));\n                    const uniqueNewProducts = nextBatch.filter(p => !existingIds.has(p.id));\n                    return [...prev, ...uniqueNewProducts];\n                });\n                setOffset(prev => prev + nextBatch.length);\n            }\n        });\n    };\n\n    // Construct Filters object for FilterSidebar compatibility (adapting to existing prop structure)\n    const filters = {\n        brands: brandsFilter,\n        calibers: calibersFilter,\n        casings: casingsFilter\n    };\n\n    // Adapter to set filters via NUQS\n    const setFilters = (newFilters: any) => {\n        if (newFilters.brands !== undefined) setBrandsFilter(newFilters.brands.length ? newFilters.brands : null);\n        if (newFilters.calibers !== undefined) setCalibersFilter(newFilters.calibers.length ? newFilters.calibers : null);\n        if (newFilters.casings !== undefined) setCasingsFilter(newFilters.casings.length ? newFilters.casings : null);\n    };\n\n\n    // 3. Facets need to be computed on *ALL* potential data if possible, or usually just loaded data.\n    // For now, computing on loaded `products`.\n    const facets = useMemo(() => {\n        const brandsMap = new Map<string, number>();\n        const calibersMap = new Map<string, number>();\n        const casingsMap = new Map<string, number>();\n\n        products.forEach(p => {\n            brandsMap.set(p.brand.name, (brandsMap.get(p.brand.name) || 0) + 1);\n            if (p.caliber) calibersMap.set(p.caliber, (calibersMap.get(p.caliber) || 0) + 1);\n            if (p.casing) casingsMap.set(p.casing, (casingsMap.get(p.casing) || 0) + 1);\n        });\n\n        const sortFn = (a: any, b: any) => b.count - a.count;\n\n        return {\n            brands: Array.from(brandsMap.entries()).map(([label, count]) => ({ label, count })).sort(sortFn),\n            calibers: Array.from(calibersMap.entries()).map(([label, count]) => ({ label, count })).sort(sortFn),\n            casings: Array.from(casingsMap.entries()).map(([label, count]) => ({ label, count })).sort(sortFn),\n        };\n    }, [products]);\n\n    // 4. Filtering Logic (Client-Side on loaded products)\n    const filteredResults = useMemo(() => {\n        let result = products.map(product => {\n            const validOffers = product.offers.filter(\n                offer => !blockedRetailers.includes(offer.retailer.name)\n            );\n            return { ...product, offers: validOffers };\n        }).filter(product => product.offers.length > 0);\n\n        // Facet Filters\n        if (brandsFilter.length) {\n            result = result.filter(p => brandsFilter.includes(p.brand.name));\n        }\n        if (calibersFilter.length) {\n            result = result.filter(p => p.caliber && calibersFilter.includes(p.caliber));\n        }\n        if (casingsFilter.length) {\n            result = result.filter(p => p.casing && casingsFilter.includes(p.casing));\n        }\n\n        // Text Search\n        if (searchQuery.trim()) {\n            const fuse = new Fuse(result, {\n                keys: ['title', 'brand.name', 'caliber'],\n                threshold: 0.3,\n            });\n            result = fuse.search(searchQuery).map(r => r.item);\n        }\n\n        return result;\n    }, [products, blockedRetailers, brandsFilter, calibersFilter, casingsFilter, searchQuery]);\n\n    const floorPrice = useMemo(() => {\n        if (filteredResults.length === 0) return undefined;\n        const prices = filteredResults.flatMap(p => p.offers.map(o => kind === 'AMMO' ? (o.cpr || 0) : o.price));\n        if (prices.length === 0) return undefined;\n        const min = Math.min(...prices);\n        return kind === 'AMMO' ? `$${min.toFixed(2)}` : `$${min.toLocaleString()}`;\n    }, [filteredResults, kind]);\n\n    const liquidity = useMemo(() => {\n        if (filteredResults.length === 0) return \"0%\";\n        const inStockCount = filteredResults.filter(p => p.offers.some(o => o.inStock)).length;\n        return `${((inStockCount / filteredResults.length) * 100).toFixed(1)}%`;\n    }, [filteredResults]);\n\n    const onRemoveFilter = (key: string, val: string) => {\n        if (key === 'brands') setBrandsFilter(prev => prev.filter(v => v !== val).length ? prev.filter(v => v !== val) : null);\n        if (key === 'calibers') setCalibersFilter(prev => prev.filter(v => v !== val).length ? prev.filter(v => v !== val) : null);\n        if (key === 'casings') setCasingsFilter(prev => prev.filter(v => v !== val).length ? prev.filter(v => v !== val) : null);\n    };\n\n    return (\n        <div className=\"max-w-7xl mx-auto py-10 px-4 sm:px-6 lg:px-8 flex flex-col lg:flex-row gap-10\">\n            <FilterSidebar\n                kind={kind}\n                facets={facets}\n                filters={filters}\n                setFilters={setFilters}\n            />\n\n            <div className=\"flex-1 min-w-0\">\n                <header className=\"mb-10\">\n                    <div className=\"flex flex-col md:flex-row md:items-end justify-between gap-6 mb-8\">\n                        <div>\n                            <h1 className=\"text-3xl font-black text-slate-900 tracking-tighter uppercase\">\n                                {kind === 'FIREARM' ? 'Firearms Index' : 'Ammunition Ledger'}\n                            </h1>\n                            <p className=\"text-slate-500 font-medium mt-1\">\n                                Real-time technical aggregate across {facets.brands.length} manufacturers.\n                            </p>\n                        </div>\n                        <div className=\"relative w-full md:w-96\">\n                            <RiSearch2Line className=\"absolute left-4 top-1/2 -translate-y-1/2 size-4 text-slate-400\" />\n                            <input\n                                type=\"text\"\n                                placeholder=\"Search caliber, SKU, brand...\"\n                                className=\"w-full bg-white border border-slate-200 rounded-xl py-3 pl-11 pr-4 text-sm font-medium shadow-xs focus:ring-4 focus:ring-slate-900/5 focus:border-slate-900 outline-none transition-all\"\n                                value={searchQuery}\n                                onChange={(e) => setSearchQuery(e.target.value || null)}\n                            />\n                        </div>\n                    </div>\n\n                    <MarketPulse\n                        count={filteredResults.length}\n                        floorPrice={floorPrice}\n                        liquidity={liquidity}\n                    />\n\n                    <QueryBar\n                        filters={filters}\n                        onRemove={onRemoveFilter}\n                        count={filteredResults.length}\n                    />\n                </header>\n\n                <div className=\"space-y-4\">\n                    {filteredResults.map(p => (\n                        kind === 'FIREARM'\n                            ? <ProductCard\n                                key={p.id}\n                                firearm={p}\n                                isComparing={compareIds.includes(p.id)}\n                                onToggleCompare={() => toggleCompare(p.id)}\n                            />\n                            : <AmmoCard\n                                key={p.id}\n                                product={p}\n                                isComparing={compareIds.includes(p.id)}\n                                onToggleCompare={() => toggleCompare(p.id)}\n                            />\n                    ))}\n\n                    {filteredResults.length === 0 ? (\n                        <div className=\"text-center py-32 bg-white rounded-3xl border border-slate-200 border-dashed\">\n                            <div className=\"text-slate-400 mb-4 font-mono text-xs uppercase tracking-[0.3em]\">No Assets Found In Index</div>\n                            <button onClick={() => { setFilters({}); setSearchQuery(null); }} className=\"text-sm font-black text-slate-900 uppercase tracking-widest hover:underline\">Clear Search Parameters</button>\n                        </div>\n                    ) : (\n                        <div className=\"mt-8 text-center pb-12\">\n                            {hasMore && (\n                                <button\n                                    onClick={handleLoadMore}\n                                    disabled={isPending}\n                                    className=\"inline-flex items-center gap-2 px-6 py-3 bg-white border border-slate-200 shadow-sm rounded-full text-sm font-bold text-slate-700 hover:bg-slate-50 hover:border-slate-300 transition-all disabled:opacity-50\"\n                                >\n                                    {isPending ? <RiLoader4Line className=\"size-4 animate-spin\" /> : null}\n                                    {isPending ? 'Loading...' : 'Scroll More'}\n                                </button>\n                            )}\n                            <div className=\"text-xs text-slate-400 mt-4 font-medium\">\n                                Showing {filteredResults.length} assets\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\n\nexport default CategoryPage;\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;;;AAbA;;;;;;;;;;;;AAoBA,MAAM,eAA4C,CAAC,EAAE,IAAI,EAAE,eAAe,EAAE;;IACxE,uCAAuC;IACvC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,8ZAAa,EAAC,KAAK,8ZAAa,CAAC,WAAW,CAAC;IACnF,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,8ZAAa,EAAC,UAAU,IAAA,+ZAAc,EAAC,8ZAAa,EAAE,WAAW,CAAC,EAAE;IAC5G,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,8ZAAa,EAAC,YAAY,IAAA,+ZAAc,EAAC,8ZAAa,EAAE,WAAW,CAAC,EAAE;IAClH,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,8ZAAa,EAAC,WAAW,IAAA,+ZAAc,EAAC,8ZAAa,EAAE,WAAW,CAAC,EAAE;IAE/G,MAAM,EACF,gBAAgB,EAChB,UAAU,EACV,aAAa,EAChB,GAAG,IAAA,uKAAS;IAEb,qBAAqB;IACrB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,qWAAQ,EAAY;IACpD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,qWAAQ,EAAC,gBAAgB,MAAM;IAC3D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,qWAAQ,EAAC,OAAO,4CAA4C;IAC1F,MAAM,CAAC,WAAW,gBAAgB,GAAG,IAAA,0WAAa;IAElD,MAAM,iBAAiB;QACnB,gBAAgB;YACZ,MAAM,YAAY,MAAM,IAAA,0JAAW,EAAC,MAAM,IAAI;YAC9C,IAAI,UAAU,MAAM,KAAK,GAAG;gBACxB,WAAW;YACf,OAAO;gBACH,YAAY,CAAA;oBACR,MAAM,cAAc,IAAI,IAAI,KAAK,GAAG,CAAC,CAAA,IAAK,EAAE,EAAE;oBAC9C,MAAM,oBAAoB,UAAU,MAAM,CAAC,CAAA,IAAK,CAAC,YAAY,GAAG,CAAC,EAAE,EAAE;oBACrE,OAAO;2BAAI;2BAAS;qBAAkB;gBAC1C;gBACA,UAAU,CAAA,OAAQ,OAAO,UAAU,MAAM;YAC7C;QACJ;IACJ;IAEA,iGAAiG;IACjG,MAAM,UAAU;QACZ,QAAQ;QACR,UAAU;QACV,SAAS;IACb;IAEA,kCAAkC;IAClC,MAAM,aAAa,CAAC;QAChB,IAAI,WAAW,MAAM,KAAK,WAAW,gBAAgB,WAAW,MAAM,CAAC,MAAM,GAAG,WAAW,MAAM,GAAG;QACpG,IAAI,WAAW,QAAQ,KAAK,WAAW,kBAAkB,WAAW,QAAQ,CAAC,MAAM,GAAG,WAAW,QAAQ,GAAG;QAC5G,IAAI,WAAW,OAAO,KAAK,WAAW,iBAAiB,WAAW,OAAO,CAAC,MAAM,GAAG,WAAW,OAAO,GAAG;IAC5G;IAGA,kGAAkG;IAClG,2CAA2C;IAC3C,MAAM,SAAS,IAAA,oWAAO;wCAAC;YACnB,MAAM,YAAY,IAAI;YACtB,MAAM,cAAc,IAAI;YACxB,MAAM,aAAa,IAAI;YAEvB,SAAS,OAAO;gDAAC,CAAA;oBACb,UAAU,GAAG,CAAC,EAAE,KAAK,CAAC,IAAI,EAAE,CAAC,UAAU,GAAG,CAAC,EAAE,KAAK,CAAC,IAAI,KAAK,CAAC,IAAI;oBACjE,IAAI,EAAE,OAAO,EAAE,YAAY,GAAG,CAAC,EAAE,OAAO,EAAE,CAAC,YAAY,GAAG,CAAC,EAAE,OAAO,KAAK,CAAC,IAAI;oBAC9E,IAAI,EAAE,MAAM,EAAE,WAAW,GAAG,CAAC,EAAE,MAAM,EAAE,CAAC,WAAW,GAAG,CAAC,EAAE,MAAM,KAAK,CAAC,IAAI;gBAC7E;;YAEA,MAAM;uDAAS,CAAC,GAAQ,IAAW,EAAE,KAAK,GAAG,EAAE,KAAK;;YAEpD,OAAO;gBACH,QAAQ,MAAM,IAAI,CAAC,UAAU,OAAO,IAAI,GAAG;oDAAC,CAAC,CAAC,OAAO,MAAM,GAAK,CAAC;4BAAE;4BAAO;wBAAM,CAAC;mDAAG,IAAI,CAAC;gBACzF,UAAU,MAAM,IAAI,CAAC,YAAY,OAAO,IAAI,GAAG;oDAAC,CAAC,CAAC,OAAO,MAAM,GAAK,CAAC;4BAAE;4BAAO;wBAAM,CAAC;mDAAG,IAAI,CAAC;gBAC7F,SAAS,MAAM,IAAI,CAAC,WAAW,OAAO,IAAI,GAAG;oDAAC,CAAC,CAAC,OAAO,MAAM,GAAK,CAAC;4BAAE;4BAAO;wBAAM,CAAC;mDAAG,IAAI,CAAC;YAC/F;QACJ;uCAAG;QAAC;KAAS;IAEb,sDAAsD;IACtD,MAAM,kBAAkB,IAAA,oWAAO;iDAAC;YAC5B,IAAI,SAAS,SAAS,GAAG;gEAAC,CAAA;oBACtB,MAAM,cAAc,QAAQ,MAAM,CAAC,MAAM;oFACrC,CAAA,QAAS,CAAC,iBAAiB,QAAQ,CAAC,MAAM,QAAQ,CAAC,IAAI;;oBAE3D,OAAO;wBAAE,GAAG,OAAO;wBAAE,QAAQ;oBAAY;gBAC7C;+DAAG,MAAM;gEAAC,CAAA,UAAW,QAAQ,MAAM,CAAC,MAAM,GAAG;;YAE7C,gBAAgB;YAChB,IAAI,aAAa,MAAM,EAAE;gBACrB,SAAS,OAAO,MAAM;6DAAC,CAAA,IAAK,aAAa,QAAQ,CAAC,EAAE,KAAK,CAAC,IAAI;;YAClE;YACA,IAAI,eAAe,MAAM,EAAE;gBACvB,SAAS,OAAO,MAAM;6DAAC,CAAA,IAAK,EAAE,OAAO,IAAI,eAAe,QAAQ,CAAC,EAAE,OAAO;;YAC9E;YACA,IAAI,cAAc,MAAM,EAAE;gBACtB,SAAS,OAAO,MAAM;6DAAC,CAAA,IAAK,EAAE,MAAM,IAAI,cAAc,QAAQ,CAAC,EAAE,MAAM;;YAC3E;YAEA,cAAc;YACd,IAAI,YAAY,IAAI,IAAI;gBACpB,MAAM,OAAO,IAAI,0OAAI,CAAC,QAAQ;oBAC1B,MAAM;wBAAC;wBAAS;wBAAc;qBAAU;oBACxC,WAAW;gBACf;gBACA,SAAS,KAAK,MAAM,CAAC,aAAa,GAAG;6DAAC,CAAA,IAAK,EAAE,IAAI;;YACrD;YAEA,OAAO;QACX;gDAAG;QAAC;QAAU;QAAkB;QAAc;QAAgB;QAAe;KAAY;IAEzF,MAAM,aAAa,IAAA,oWAAO;4CAAC;YACvB,IAAI,gBAAgB,MAAM,KAAK,GAAG,OAAO;YACzC,MAAM,SAAS,gBAAgB,OAAO;2DAAC,CAAA,IAAK,EAAE,MAAM,CAAC,GAAG;mEAAC,CAAA,IAAK,SAAS,SAAU,EAAE,GAAG,IAAI,IAAK,EAAE,KAAK;;;YACtG,IAAI,OAAO,MAAM,KAAK,GAAG,OAAO;YAChC,MAAM,MAAM,KAAK,GAAG,IAAI;YACxB,OAAO,SAAS,SAAS,CAAC,CAAC,EAAE,IAAI,OAAO,CAAC,IAAI,GAAG,CAAC,CAAC,EAAE,IAAI,cAAc,IAAI;QAC9E;2CAAG;QAAC;QAAiB;KAAK;IAE1B,MAAM,YAAY,IAAA,oWAAO;2CAAC;YACtB,IAAI,gBAAgB,MAAM,KAAK,GAAG,OAAO;YACzC,MAAM,eAAe,gBAAgB,MAAM;mDAAC,CAAA,IAAK,EAAE,MAAM,CAAC,IAAI;2DAAC,CAAA,IAAK,EAAE,OAAO;;kDAAG,MAAM;YACtF,OAAO,GAAG,CAAC,AAAC,eAAe,gBAAgB,MAAM,GAAI,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;QAC3E;0CAAG;QAAC;KAAgB;IAEpB,MAAM,iBAAiB,CAAC,KAAa;QACjC,IAAI,QAAQ,UAAU,gBAAgB,CAAA,OAAQ,KAAK,MAAM,CAAC,CAAA,IAAK,MAAM,KAAK,MAAM,GAAG,KAAK,MAAM,CAAC,CAAA,IAAK,MAAM,OAAO;QACjH,IAAI,QAAQ,YAAY,kBAAkB,CAAA,OAAQ,KAAK,MAAM,CAAC,CAAA,IAAK,MAAM,KAAK,MAAM,GAAG,KAAK,MAAM,CAAC,CAAA,IAAK,MAAM,OAAO;QACrH,IAAI,QAAQ,WAAW,iBAAiB,CAAA,OAAQ,KAAK,MAAM,CAAC,CAAA,IAAK,MAAM,KAAK,MAAM,GAAG,KAAK,MAAM,CAAC,CAAA,IAAK,MAAM,OAAO;IACvH;IAEA,qBACI,yXAAC;QAAI,WAAU;;0BACX,yXAAC,oKAAa;gBACV,MAAM;gBACN,QAAQ;gBACR,SAAS;gBACT,YAAY;;;;;;0BAGhB,yXAAC;gBAAI,WAAU;;kCACX,yXAAC;wBAAO,WAAU;;0CACd,yXAAC;gCAAI,WAAU;;kDACX,yXAAC;;0DACG,yXAAC;gDAAG,WAAU;0DACT,SAAS,YAAY,mBAAmB;;;;;;0DAE7C,yXAAC;gDAAE,WAAU;;oDAAkC;oDACL,OAAO,MAAM,CAAC,MAAM;oDAAC;;;;;;;;;;;;;kDAGnE,yXAAC;wCAAI,WAAU;;0DACX,yXAAC,mRAAa;gDAAC,WAAU;;;;;;0DACzB,yXAAC;gDACG,MAAK;gDACL,aAAY;gDACZ,WAAU;gDACV,OAAO;gDACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK,IAAI;;;;;;;;;;;;;;;;;;0CAK9D,yXAAC,kKAAW;gCACR,OAAO,gBAAgB,MAAM;gCAC7B,YAAY;gCACZ,WAAW;;;;;;0CAGf,yXAAC,+JAAQ;gCACL,SAAS;gCACT,UAAU;gCACV,OAAO,gBAAgB,MAAM;;;;;;;;;;;;kCAIrC,yXAAC;wBAAI,WAAU;;4BACV,gBAAgB,GAAG,CAAC,CAAA,IACjB,SAAS,0BACH,yXAAC,kKAAW;oCAEV,SAAS;oCACT,aAAa,WAAW,QAAQ,CAAC,EAAE,EAAE;oCACrC,iBAAiB,IAAM,cAAc,EAAE,EAAE;mCAHpC,EAAE,EAAE;;;;6FAKX,yXAAC,+JAAQ;oCAEP,SAAS;oCACT,aAAa,WAAW,QAAQ,CAAC,EAAE,EAAE;oCACrC,iBAAiB,IAAM,cAAc,EAAE,EAAE;mCAHpC,EAAE,EAAE;;;;;4BAOpB,gBAAgB,MAAM,KAAK,kBACxB,yXAAC;gCAAI,WAAU;;kDACX,yXAAC;wCAAI,WAAU;kDAAmE;;;;;;kDAClF,yXAAC;wCAAO,SAAS;4CAAQ,WAAW,CAAC;4CAAI,eAAe;wCAAO;wCAAG,WAAU;kDAA8E;;;;;;;;;;;yFAG9J,yXAAC;gCAAI,WAAU;;oCACV,yBACG,yXAAC;wCACG,SAAS;wCACT,UAAU;wCACV,WAAU;;4CAET,0BAAY,yXAAC,mRAAa;gDAAC,WAAU;;;;;2FAA2B;4CAChE,YAAY,eAAe;;;;;;;kDAGpC,yXAAC;wCAAI,WAAU;;4CAA0C;4CAC5C,gBAAgB,MAAM;4CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQhE;GApNM;;QAEoC,8ZAAa;QACX,8ZAAa;QACT,8ZAAa;QACf,8ZAAa;QAMnD,uKAAS;QAMwB,0WAAa;;;KAjBhD;uCAuNS"}}]
}